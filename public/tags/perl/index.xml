<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Perl on kobaken&#39;s blog</title>
    <link>http://kfly8.github.io/tags/perl/</link>
    <description>Recent content in Perl on kobaken&#39;s blog</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja</language>
    <lastBuildDate>Sun, 20 Dec 2015 20:43:25 +0900</lastBuildDate>
    <atom:link href="http://kfly8.github.io/tags/perl/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>About Dancer2(ja)</title>
      <link>http://kfly8.github.io/post/about-dancer2/</link>
      <pubDate>Sun, 20 Dec 2015 20:43:25 +0900</pubDate>
      
      <guid>http://kfly8.github.io/post/about-dancer2/</guid>
      <description>

&lt;p&gt;この記事は、&lt;a href=&#34;http://qiita.com/advent-calendar/2015/perl5&#34;&gt;Perl5 Advent Calendar 2015&lt;/a&gt; の20日目の記事です。&lt;/p&gt;

&lt;p&gt;Web Application Framework の Dancer2 について紹介したいと思います。&lt;/p&gt;

&lt;p&gt;まずは、YAPC::Asia 2014 の LT から。
こちらは、Dancer2 のリリースマネージャーの &lt;a href=&#34;https://twitter.com/perlsawyer&#34;&gt;SawyerX&lt;/a&gt; による、Dancer2の超速紹介です。
Dancer2 の要点が凝縮されたLTです。&lt;/p&gt;


&lt;div style=&#34;position: relative; padding-bottom: 56.25%; padding-top: 30px; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/0gapHdDTRUk&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%;&#34; allowfullscreen frameborder=&#34;0&#34;&gt;&lt;/iframe&gt;
 &lt;/div&gt;


&lt;p&gt;目を凝らすとこんなスライドが見えます。DSLで、ルーティングを記述します。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;package MyApp;
use Dancer2;

get &#39;/&#39; =&amp;gt; sub {
   template index =&amp;gt; {
      name =&amp;gt; &#39;Sawyer X&#39;,
      event =&amp;gt; &#39;YAPC::Asia&#39;
   }
};
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;JSON を返却するようなAPIも簡単に用意できます。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;package MyApp::API;
use Dancer2;

set serializer =&amp;gt; &#39;JSON&#39;;

get &#39;/&#39; =&amp;gt; sub {
    return {
        hello =&amp;gt; &#39;world&#39;,
    }
};
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Dancer2 は Plack化されているので、plackupできます。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;# app.psgi
use MyApp;
my $app = MyApp-&amp;gt;psgi_app;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-sh&#34;&gt;plackup app.psgi
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ここまでが、LTの抜粋です。&lt;/p&gt;

&lt;p&gt;Dancer2 は、元々、Ruby のSinatra を Perl に port した Dancer の次バージョンです。
Dancer の DSL はほぼそのままに、設計面での調整が大幅に入っています&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;http://advent.perldancer.org/2014/2&#34;&gt;http://advent.perldancer.org/2014/2&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;例えば、以下のような対応が行われています。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Plack 対応&lt;/li&gt;
&lt;li&gt;DSL 実装を、Top 空間から、Dancer2::Core::DSL に分解&lt;/li&gt;
&lt;li&gt;Moo 採用&lt;/li&gt;
&lt;li&gt;デザインパターンの調整（デメテルの法則&amp;hellip;）&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;この対応に関して、2011 年の Dancer Advent Calendar にて、（超訳ですが）「全部書き換えるぞい」という記事があります。&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;http://advent.perldancer.org/2011/8&#34;&gt;http://advent.perldancer.org/2011/8&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;利用者が多数のプロダクトにおいて、こういった完全な書き換えは、個人的な興味をそそりました。
今現在も活発に開発され、Dancer という名前を冠するPerl &lt;a href=&#34;https://www.perl.dance/&#34;&gt;カンファレンス&lt;/a&gt;も開かれています。&lt;/p&gt;

&lt;p&gt;Dancer を作った sukria のポスト。&lt;/p&gt;

&lt;iframe src=&#34;//blog.sukria.net/2015/10/22/perl-dancer-2015-report/embed/&#34;
  class=&#34;wp-embedded-content&#34;
  frameborder=&#34;0&#34;
  scrolling=&#34;no&#34;
  style=&#34;display: block; width: 100%; height: 338px; max-width: 600px; margin: 10px 0px;&#34;
&gt;&lt;/iframe&gt;



&lt;p&gt;最近の開発状況の話。&lt;/p&gt;


&lt;div style=&#34;position: relative; padding-bottom: 56.25%; padding-top: 30px; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/UbU5R-SHbDE&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%;&#34; allowfullscreen frameborder=&#34;0&#34;&gt;&lt;/iframe&gt;
 &lt;/div&gt;


&lt;p&gt;（Dancer2::XS ってあって、すごいってなった）&lt;/p&gt;

&lt;p&gt;もう少し、Dancer2 の特徴を触れて、記事を終わりにしたいと思います。
（と言っても、ほぼ、&lt;a href=&#34;http://advent.perldancer.org/2014&#34;&gt;2014 年の dancer advent calendar&lt;/a&gt; ((SawyerX の一人アドベントカレンダー。つよい。)) からの抜粋です。&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;http://advent.perldancer.org/2014/5&#34;&gt;http://advent.perldancer.org/2014/5&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;fatpack、つまり一枚スクリプトにするのをサポートしています。
（なので、XSモジュールは、recommend 扱いです）&lt;/p&gt;

&lt;p&gt;ポータビリティを考えると良い選択になるかもしれません。&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;http://advent.perldancer.org/2014/16&#34;&gt;http://advent.perldancer.org/2014/16&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;コマンドラインで利用も考慮されています。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use Dancer2;

warn config-&amp;gt;{environment}; # =&amp;gt; development
warn dancer_version;        # =&amp;gt; 0.165000
&lt;/code&gt;&lt;/pre&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;http://advent.perldancer.org/2014/10&#34;&gt;http://advent.perldancer.org/2014/10&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;複数のアプリケーションの同居が考慮されています。
Dancer2 に appname を渡すことで、config やdbh などが、appname ごとに管理されます。&lt;/p&gt;

&lt;p&gt;以下の例だと、
MyApp::Foo1, Foo2 で、一つの Dancer2::Core::App obj が作られ、
Bar にもう一つの Dancer2::Core::App obj が作られます。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;package MyApp::Foo1 {
  use Dancer2 appname =&amp;gt; &#39;foo&#39;;
  get &#39;/&#39; =&amp;gt; sub { ... }
}

package MyApp::Foo2 {
  use Dancer2 appname =&amp;gt; &#39;foo&#39;;
  get &#39;/&#39; =&amp;gt; sub { ... }
}

package MyApp::Bar {
  use Dancer2;
  get &#39;/&#39; =&amp;gt; sub { ... }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;まとめ:d5fa33a926e58371ddf4a9e076d3305f&#34;&gt;まとめ&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;なんだか Dancer2 楽しそうだぞ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;明日は、&lt;a href=&#34;https://twitter.com/akihiro_0228&#34;&gt;akihiro_0228&lt;/a&gt; さんです。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>設定とFixture</title>
      <link>http://kfly8.github.io/post/setting-and-fixture/</link>
      <pubDate>Wed, 02 Dec 2015 18:53:37 +0900</pubDate>
      
      <guid>http://kfly8.github.io/post/setting-and-fixture/</guid>
      <description>

&lt;p&gt;&lt;strong&gt;この記事は、&lt;a href=&#34;http://qiita.com/advent-calendar/2015/mobilefactory&#34;&gt;モバイルファクトリー Advent Calendar 2015&lt;/a&gt; 2日目の記事です&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;昨日は、nekobato さんの &lt;a href=&#34;http://qiita.com/nekobato/items/0cd3ed1742310f74653c&#34;&gt;superagentとaxiosの使い分け&lt;/a&gt; でした&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://qiita.com/advent-calendar/2014/perl&#34;&gt;Perl Advent Calender 2014&lt;/a&gt; の最高の記事の
&lt;a href=&#34;http://www.songmu.jp/riji/entry/2014-12-25-test-anything.html&#34;&gt;ソースコード以外もとにかくテストする。もしくはカバレッジだけではダメだという話&lt;/a&gt; から、
&lt;code&gt;アプリケーション設定ファイルのテスト&lt;/code&gt; と &lt;code&gt;Fixtureのテスト&lt;/code&gt; の例を書いてみたいと思います&lt;/p&gt;

&lt;h1 id=&#34;アプリケーション設定ファイルのテスト:d08054f2f5aa943738fabfb18293ec30&#34;&gt;アプリケーション設定ファイルのテスト&lt;/h1&gt;

&lt;p&gt;本番環境、開発環境、テスト環境で設定が過不足がないかチェックするため、
&lt;a href=&#34;https://metacpan.org/pod/Test%3A%3ADeep&#34;&gt;Test::Deep&lt;/a&gt;, &lt;a href=&#34;https://metacpan.org/pod/Test%3A%3ADeep%3A%3AMatcher&#34;&gt;Test::Deep::Matcher&lt;/a&gt; を利用しています&lt;/p&gt;

&lt;p&gt;テストの流れとしては&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;本番環境の設定値を、Test::Deep::Matcher のmatcher に変換&lt;/li&gt;
&lt;li&gt;開発環境、テスト環境の設定値が、matcher にあうか比較&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;です&lt;/p&gt;

&lt;p&gt;例えば、以下のような本番設定があったとして..&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-json&#34;&gt;# production.pl
{
  servers =&amp;gt; [
    &#39;XX.XX.XXX.XXX:11211&#39;,
    &#39;XX.XX.XXX.YYY:11211&#39;,
  ],
  options =&amp;gt; {
    utf8 =&amp;gt; 1,
  },
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;再帰的にmatcherに変換してあげます&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use Test::Deep::Matcher;
use Test::Deep qw//;

sub convert_matcher {
    my $v = shift;

    if (!ref $v) {
        return Data::Util::is_integer($v) ? is_integer
             : Data::Util::is_number($v)  ? is_number
             : Data::Util::is_string($v)  ? is_string
             : Data::Util::is_value($v)   ? is_value
             : undef;
    }
    elsif(ref $v eq &#39;ARRAY&#39;) {
        return Test::Deep::array_each(convert_matcher($v-&amp;gt;[0])) # XXX: 仮定
    }
    elsif(rev $v eq &#39;HASH&#39;) {
        return +{ map { $_ =&amp;gt; convert_matcher($v-&amp;gt;{$_}) } keys %$v }
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;あとは比較するだけです&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;my $expect = convert_matcher($production_conf)
cmp_deeply $development_conf, $expect;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;余談:d08054f2f5aa943738fabfb18293ec30&#34;&gt;(余談)&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;上の例では、本番環境の設定から(雑な)型推定をしました&lt;/li&gt;
&lt;li&gt;設定の型定義を用意しておけるなら、その方が良いかもしれません

&lt;ul&gt;
&lt;li&gt;異常値などの定義をしやすいですし&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;以下、&lt;code&gt;crystal&lt;/code&gt; の例です&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;require &amp;quot;json&amp;quot;

class Config
  JSON.mapping({
    servers: String,
    options: { type: ServerOptions },
  })
end

class ServerOptions
  JSON.mapping({
    utf8: Int32
  })
end
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;fixture-のテスト:d08054f2f5aa943738fabfb18293ec30&#34;&gt;Fixture のテスト&lt;/h1&gt;

&lt;p&gt;リレーションチェックのため、
&lt;a href=&#34;https://metacpan.org/pod/DBIx%3A%3ASchema%3A%3ADSL&#34;&gt;DBIx::Schema::DSL&lt;/a&gt;, &lt;a href=&#34;https://metacpan.org/pod/SQL%3A%3ATranslator%3A%3ASchema&#34;&gt;SQL::Translator::Schema&lt;/a&gt; を利用しています&lt;/p&gt;

&lt;p&gt;チェックには、外部キー制約を利用します
実際のアプリケーションでの利用は、&lt;a href=&#34;http://connpass.com/event/11463/&#34;&gt;諸事情&lt;/a&gt; でしていないですが、
テストでの利用では最高に便利です
(この辺の外部キーありなしのスイッチを、&lt;code&gt;no_fk_output/output&lt;/code&gt; だけで簡単にできるのが、&lt;code&gt;DBIx::Schema::DSL&lt;/code&gt; めっちゃ便利だーってなって便利です)&lt;/p&gt;

&lt;p&gt;流れは、&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;外部キー制約つきのスキーマを用意して、&lt;code&gt;INSERT&lt;/code&gt; する&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;だけです。
ただ、エラーメッセージを、人間が読みやすい形にするため、地味にループを回すようなコードにしています:p&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;# Schema
use 5.014002;
package MyProj::DB::Schema {
    use DBIx::Schema::DSL;

    create_table &#39;module&#39; =&amp;gt; columns {
        integer &#39;id&#39;, primary_key, auto_increment;
        varchar &#39;name&#39;;
        integer &#39;author_id&#39;;

        add_index &#39;author_id_idx&#39; =&amp;gt; [&#39;author_id&#39;];

        belongs_to &#39;author&#39;;
    };

    create_table &#39;author&#39; =&amp;gt; columns {
        integer &#39;id&#39;, primary_key, auto_increment;
        varchar &#39;name&#39;, unique;
    };
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;# belongs_to.t

$db-&amp;gt;execute(MyProj::DB::Schema-&amp;gt;output);

my $schema         = MyProj::DB::Schema-&amp;gt;context-&amp;gt;schema;
my $module_schema  = $schema-&amp;gt;get_table(&#39;module&#39;);
my $constraints    = $module_schema-&amp;gt;fkey_constraints;

for my $fkey (@$constraints) {
    my $ref_table = $fkey-&amp;gt;reference_table;

    my @errors = try_load($ref_table);
    ok !@errors
       or note explain @errors;
}

sub try_load {
    my ($table) = @_;

    my @errors;
    for my $row (@{$FIXTURE_DATA{$table}}) {
        try {
            $db-&amp;gt;insert($table =&amp;gt; $row);
        }
        catch {
            push @errors =&amp;gt; shift;
        };
    }
    return @errors;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;まとめ:d08054f2f5aa943738fabfb18293ec30&#34;&gt;まとめ&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;アプリケーション設定ファイルのテスト&lt;/code&gt; と &lt;code&gt;Fixtureのテスト&lt;/code&gt; の実装例を紹介しました&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;明日は、 nekobato さんです!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>DBIx::Schema::DSL::Dumper というのを書きました</title>
      <link>http://kfly8.github.io/post/dbix-schema-dsl-dumper/</link>
      <pubDate>Wed, 04 Feb 2015 21:00:12 +0900</pubDate>
      
      <guid>http://kfly8.github.io/post/dbix-schema-dsl-dumper/</guid>
      <description>&lt;p&gt;songmuさんの書いた&lt;a href=&#34;https://github.com/Songmu/p5-DBIx-Schema-DSL&#34;&gt;DBIx::Schema::DSL&lt;/a&gt;
を使いたい状況が出て来て、
すでに結構もりもり書かれてたDDLを移行する為に書いてみました。&lt;/p&gt;

&lt;p&gt;使い方は、&lt;a href=&#34;http://search.cpan.org/~satoh/Teng-0.19/lib/Teng/Schema/Dumper.pm&#34;&gt;Teng::Schema::Dumper&lt;/a&gt;
と同じように、&lt;code&gt;$dbh&lt;/code&gt; を渡すだけで、DSLが吐き出せます。&lt;/p&gt;

&lt;p&gt;雰囲気は次のような感じです！&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use DBI;
use DBIx::Schema::DSL::Dumper;

my $dbh = DBI-&amp;gt;connect(&#39;dbi:mysql:dbname=test&#39;, &#39;root&#39;, &#39;&#39;);
print DBIx::Schema::DSL::Dumper-&amp;gt;dump(
    dbh =&amp;gt; $dbh,
    pkg =&amp;gt; &#39;Foo::DSL&#39;,
);

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;よかったら使ってほしいです！&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>間接オブジェクト記法のアンチパターン</title>
      <link>http://kfly8.github.io/post/indirect-object-notation/</link>
      <pubDate>Wed, 17 Dec 2014 12:54:09 +0900</pubDate>
      
      <guid>http://kfly8.github.io/post/indirect-object-notation/</guid>
      <description>

&lt;p&gt;この記事は &lt;a href=&#34;http://qiita.com/advent-calendar/2014/perl&#34;&gt;Perl Advent Calendar 2014&lt;/a&gt; の 17日目 の記事です。&lt;/p&gt;

&lt;p&gt;16日目の記事は &lt;a href=&#34;http://qiita.com/magnolia_k_&#34;&gt;magnolia&lt;em&gt;k&lt;/em&gt;&lt;/a&gt; さんの &lt;a href=&#34;http://qiita.com/magnolia_k_/items/b0a14e29c8090568f5b3&#34;&gt;perlの関数を第一級オブジェクトとして扱う話&lt;/a&gt; でした&lt;/p&gt;

&lt;h1 id=&#34;目次:ed130a5c49b36845906533f63e9cb3a3&#34;&gt;目次&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#section1&#34;&gt;はじめに&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#section2&#34;&gt;間接オブジェクト記法ってそもそも何？&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#section3&#34;&gt;間接オブジェクト記法が活きる例&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#section4&#34;&gt;ハマる例1 Try::Tiny のuse 漏れ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#section5&#34;&gt;余談 code block&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#section6&#34;&gt;ハマる例2? UNIVERSAL&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#section7&#34;&gt;ハマる例3 テストにて&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#section8&#34;&gt;まとめ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#section9&#34;&gt;明日&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;a-name-section1-はじめに-a:ed130a5c49b36845906533f63e9cb3a3&#34;&gt;&lt;a name=&#34;section1&#34;&gt;はじめに&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;15日目の記事の id:akihiro0228 さんの記事を読んで、
&lt;iframe src=&#34;//akihiro0228.hatenablog.com/embed/2014/12/15/221806&#34;
 class=&#34;embed-card embed-blogcard&#34;
 scrolling=&#34;no&#34;
 frameborder=&#34;0&#34;
 style=&#34;display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;&#34;
&gt;&lt;/iframe&gt;
&lt;/p&gt;

&lt;p&gt;自分がよくハマってしまう&lt;a href=&#34;http://perldoc.jp/docs/perl/5.8.8/perlobj.pod#Indirect32Object32Syntax&#34;&gt;間接オブジェクト記法&lt;/a&gt;について紹介したいと思います。
&lt;b&gt;便乗です！&lt;/b&gt;&lt;/p&gt;

&lt;h1 id=&#34;a-name-section2-間接オブジェクト記法ってそもそも何-a:ed130a5c49b36845906533f63e9cb3a3&#34;&gt;&lt;a name=&#34;section2&#34;&gt;間接オブジェクト記法ってそもそも何？&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;メソッドを呼び出しの別表現です&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;$obj-&amp;gt;method($a, $b); # 普段の呼び出し

method $obj $a, $b;   # 間接オブジェクト記法
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;一番なじみやすい例はnewだと思います&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;my $dog = new Dog;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;普段は、誤読につながりやすいのであまり使うことをおすすめしないです
ですが、意図せず間接オブジェクト記法な呼び出しにしてしまったり、
この表現の方が簡潔に書ける例もあったりするので紹介してみたいと思います&lt;/p&gt;

&lt;h1 id=&#34;a-name-section3-間接オブジェクト記法が活きる例-a:ed130a5c49b36845906533f63e9cb3a3&#34;&gt;&lt;a name=&#34;section3&#34;&gt;間接オブジェクト記法が活きる例&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;定数を扱う時に便利なconstantプラグマを使ってみます
普段使う時は、以下のような感じで使うと思います&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use constant FOO =&amp;gt; &#39;foo&#39;;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;これを動的に定数定義してみたいとします&lt;/p&gt;

&lt;p&gt;動的に定義したい場合は
&lt;code&gt;use XXX&lt;/code&gt; は、&lt;code&gt;BEGIN { require XXX; do { XXX-&amp;gt;import } }&lt;/code&gt; のsugarなので、
このsugarをほどいて１つ１つ自分で順に追ってやれば変数だったりが使えます&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;package XXX;

BEGIN {
    require constant;
    constant-&amp;gt;import(FOO =&amp;gt; &#39;foo&#39; x 4);
}

say FOO; # =&amp;gt; foofoofoofoo
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;間接オブジェクト記法を使ってみると以下のようになります&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;package YYY;

BEGIN {
    require constant;
    import constant FOO =&amp;gt; &#39;foo&#39; x 4;
}

say FOO; # =&amp;gt; foofoofoofoo
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;どうですかね？
普段のconstantプラグマの使い方に近く、簡潔に書けているように思います&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;逆に今度は、よくあるハマる例を書いてみます&lt;/p&gt;

&lt;h1 id=&#34;a-name-section4-ハマる例1-try-tiny-のuse-漏れ-a:ed130a5c49b36845906533f63e9cb3a3&#34;&gt;&lt;a name=&#34;section4&#34;&gt;ハマる例1 Try::Tiny のuse 漏れ&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;ずばり、 id:karupanerura 先生の話を例を取ってみます。&lt;/p&gt;

&lt;iframe src=&#34;//techblog.karupas.org/embed/20111117/1321542949&#34;
 class=&#34;embed-card embed-blogcard&#34;
 scrolling=&#34;no&#34;
 frameborder=&#34;0&#34;
 style=&#34;display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;&#34;
&gt;&lt;/iframe&gt;


&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;
use feature &#39;say&#39;;

# XXX わざとuseしないで、errorを起こす
#use Try::Tiny;

try {
    say &#39;foo&#39;;
    say &#39;bar&#39;;
}
# =&amp;gt;
# foo
# bar
# Can&#39;t locate object method &amp;quot;try&amp;quot; via package &amp;quot;1&amp;quot; (perhaps you forgot to load &amp;quot;1&amp;quot;?) at try2.pl line 6.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;このエラーだとよくわからないので、
7日目の id:papix さんと11日目の id:hisaichi5518 さんが紹介しているB::Deparseを使います&lt;/p&gt;

&lt;iframe src=&#34;//papix.hatenablog.com/embed/2014/12/07/150335&#34;
 class=&#34;embed-card embed-blogcard&#34;
 scrolling=&#34;no&#34;
 frameborder=&#34;0&#34;
 style=&#34;display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;&#34;
&gt;&lt;/iframe&gt;


&lt;iframe src=&#34;//hisaichi5518.hatenablog.jp/embed/2014/12/11/222358&#34;
 class=&#34;embed-card embed-blogcard&#34;
 scrolling=&#34;no&#34;
 frameborder=&#34;0&#34;
 style=&#34;display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;&#34;
&gt;&lt;/iframe&gt;


&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;# perl -MO=Deparse %

use utf8;
use warnings;
use strict;
use feature &#39;say&#39;;
do {
    say &#39;foo&#39;;
    say &#39;bar&#39;
}-&amp;gt;try;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;do の最後に評価された 1 を package として、1-&amp;gt;try みたいなことをしています&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Can&#39;t locate object method &amp;quot;try&amp;quot; via package &amp;quot;1&amp;quot; (perhaps you forgot to load &amp;quot;1&amp;quot;?) at try2.pl line 6.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;package&lt;/code&gt;が1だとちょっと分かりにくいと思うので、
次の例を見てみてください&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;
use feature &#39;say&#39;;

#use Try::Tiny;

try {
    say &#39;foo&#39;;
    bless {}, &#39;foo&#39;; # XXX obj を最後においてやる
}
# =&amp;gt;
# foo
# Can&#39;t locate object method &amp;quot;try&amp;quot; via package &amp;quot;foo&amp;quot; at try2.pl line 6.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Deparse すると以下のようになります&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use utf8;
use warnings;
use strict;
use feature &#39;say&#39;;
do {
    say &#39;foo&#39;;
    bless {}, &#39;foo&#39;
}-&amp;gt;try;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;今度のエラーと、Deparse した例を見ると、foo-&amp;gt;try と呼び出しされたことが分かってもらえると思います&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# Can&#39;t locate object method &amp;quot;try&amp;quot; via package &amp;quot;foo&amp;quot; at try2.pl line 6.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;最後にちゃんと &lt;code&gt;use Try::Tiny&lt;/code&gt; した例です&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;
use feature &#39;say&#39;;

use Try::Tiny;

try {
    say &#39;foo&#39;;
    bless {}, &#39;foo&#39;;
}
# =&amp;gt; foo
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;# perl -MO=Deparse %

use utf8;
use Try::Tiny;
use warnings;
use strict;
use feature &#39;say&#39;;
try sub {
    say &#39;foo&#39;;
    bless {}, &#39;foo&#39;;
}
;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Deparse したコードを見ると、try に coderef が渡されていることが分かると思います&lt;/p&gt;

&lt;h1 id=&#34;a-name-section5-余談-code-block-a:ed130a5c49b36845906533f63e9cb3a3&#34;&gt;&lt;a name=&#34;section5&#34;&gt;余談 code block&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;&lt;a href=&#34;https://metacpan.org/source/DOY/Try-Tiny-0.22/lib/Try/Tiny.pm#L24&#34;&gt;Try::Tiny の try のコード&lt;/a&gt;
を見ると、次のようにサブルーチン名に&lt;code&gt;(&amp;amp;;@)&lt;/code&gt;といった指定がされています&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;sub try (&amp;amp;;@) {
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;これはプロトタイプと呼ばれるものです
&amp;gt; &lt;a href=&#34;http://perldoc.jp/docs/perl/5.6.1/perlsub.pod#Prototypes&#34;&gt;http://perldoc.jp/docs/perl/5.6.1/perlsub.pod#Prototypes&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;これにより、blockで、coderef を表現できるので、より簡潔な記法ができます
try 以外にも、grep, mapなどが身近な例だと思います&lt;/p&gt;

&lt;h3 id=&#34;coderef-を実行しながら-sumを取る関数を実装してみます:ed130a5c49b36845906533f63e9cb3a3&#34;&gt;coderef を実行しながら、sumを取る関数を実装してみます&lt;/h3&gt;

&lt;p&gt;まずは、prototypeを使わない例&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;
use Test::More;
use Test::Exception;
use Test::Perl::Critic;
use List::Util qw/sum/;

sub sum_map {
    my $cb = shift;
    sum map { $cb-&amp;gt;($_); } @_;
}

subtest &#39;basic&#39; =&amp;gt; sub {

    is sum_map(sub { $_[0] * 10 }, 1..10), 550;
};

subtest &#39;dies&#39; =&amp;gt; sub {

    dies_ok { sum_map { $_ * 10 }, 1..10; }

    # =&amp;gt;
    # Use of uninitialized value $_ in multiplication (*) at proto.pl line 23.
    # Odd number of elements in anonymous hash at proto.pl line 23.
    # Not a CODE reference at proto.pl line 10.
};

subtest &#39;critic&#39; =&amp;gt; sub {
    critic_ok($0);
};

done_testing;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;次にprototypeを指定してみます&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use warnings;
use utf8;
use Test::More;
use Test::Exception;
use Test::Perl::Critic;
use List::Util qw/sum/;

sub sum_map (&amp;amp;@) {
    my $cb = shift;
    sum map { $cb-&amp;gt;($_) } @_;
}

subtest &#39;basic&#39; =&amp;gt; sub {

    my $ret = sum_map { $_ * 10 } 1..10;
    is $ret, 550;
};

subtest &#39;other use case&#39; =&amp;gt; sub {

    my $ret = sum_map(sub { $_[0] * 10 }, 1..10);
    is $ret, 550;
};

subtest &#39;critic&#39; =&amp;gt; sub {
    critic_ok($0); ## failed!!

    # not ok 1 - Test::Perl::Critic for &amp;quot;proto2.pl&amp;quot;
    # Failed test &#39;Test::Perl::Critic for &amp;quot;proto2.pl&amp;quot;&#39;
    #   at proto2.pl line 27.
    #
    # Perl::Critic found these violations in &amp;quot;proto2.pl&amp;quot;:
    # Subroutine prototypes used at line 9, column 1.  See page 194 of PBP.  (Severity: 5)
};

done_testing;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;critic のテストが通りませんでした
blockが coderef になっているのは、確かに副作用が強いです
その為、多用はしたくないです&lt;/p&gt;

&lt;p&gt;以下のように ## no critic と注釈をつけてあげて、
副作用を許容してあげることができます
&amp;gt; &lt;a href=&#34;http://search.cpan.org/~thaljef/Perl-Critic-1.123/lib/Perl/Critic.pm#BENDING_THE_RULES&#34;&gt;http://search.cpan.org/~thaljef/Perl-Critic-1.123/lib/Perl/Critic.pm#BENDING_THE_RULES&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;
use Test::More;
use Test::Exception;
use Test::Perl::Critic;
use List::Util qw/sum/;

sub sum_map (&amp;amp;@) { ## no critic
    my $cb = shift;
    sum map { $cb-&amp;gt;($_) } @_;
}

subtest &#39;critic&#39; =&amp;gt; sub {
    critic_ok($0), &#39;注釈をつけることで回避&#39;;
};

done_testing;
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;a-name-section6-ハマる例2-universal-a:ed130a5c49b36845906533f63e9cb3a3&#34;&gt;&lt;a name=&#34;section6&#34;&gt;ハマる例2? UNIVERSAL&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;間接オブジェクトわざとらしく使ってみたいと思います
&lt;code&gt;can&lt;/code&gt;を使っているのがわざとらしいです！&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;
use feature qw/say/;

my $dog = bless {}, &#39;Dog&#39;;

if (can $dog &#39;bow&#39;) {
    say &#39;can bow&#39;;
}
else {
    say &#39;cannot bow&#39;;
} # =&amp;gt; cannot bow

&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;#perl -MO=Deparse %

use utf8;
use warnings;
use strict;
use feature &#39;say&#39;;
my $dog = bless({}, &#39;Dog&#39;);
if ($dog-&amp;gt;can(&#39;bow&#39;)) {
    say &#39;can bow&#39;;
}
else {
    say &#39;cannot bow&#39;;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;# original
if (can $dog &#39;bow&#39;)

# Deparse
if ($dog-&amp;gt;can(&#39;bow&#39;)) {
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;$dogにcan methodは生やしていないですが、
Perlの場合、全てのクラスは暗黙的にUNIVERSAL を元にするようになっているので、
$dog-&amp;gt;can で UNIVERSAL-&amp;gt;can が呼び出しされます&lt;/p&gt;

&lt;p&gt;試しに、UNIVERSALのcanが呼び出しされないように、
このパッケージに &lt;code&gt;can&lt;/code&gt; というサブルーチンを生やしてみます&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;
use feature qw/say/;

my $dog = bless {}, &#39;Dog&#39;;

sub can { 1 }

if (can $dog &#39;bow&#39;) { # XXX =&amp;gt; syntax error
    say &#39;can bow&#39;;
}
else {
    say &#39;cannot bow&#39;;
}

=pod

syntax error at can2.pl line 10, near &amp;quot;$dog &#39;bow&#39;&amp;quot;
can2.pl had compilation errors.
use utf8;
use warnings;
use strict;
use feature &#39;say&#39;;
my $dog = bless({}, &#39;Dog&#39;);
sub can {
    use warnings;
    use strict;
    use feature &#39;say&#39;;
    1;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;$dog と &amp;lsquo;bow&amp;rsquo; の間にカンマがなくて、エラーになりました
もちろんカンマを入れれば、次のように、&amp;rsquo;can bow&amp;rsquo;と表示されます&lt;/p&gt;

&lt;p&gt;このカンマのあるなしの意思表示で、間接記法であるかどうか示します
それは意思表示としては、わかりずらいので、誤読の元になりやすいです&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;
use feature qw/say/;

my $dog = bless {}, &#39;Dog&#39;;

sub can { 1 }

if (can $dog, &#39;bow&#39;) { # リストにするため、カンマを入れた
    say &#39;can bow&#39;;
}
else {
    say &#39;cannot bow&#39;;
} # =&amp;gt; can bow

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;このように暗黙に定義されたメソッドで、間接オブジェクト記法が出てくるなんて、
あまりないと思いますが、良い機会なので、
UNIVERSALに生えているメソッドを洗ってみます&lt;/p&gt;

&lt;p&gt;Class::Inspector を使うと、&lt;code&gt;can, isa, VERSION, DOES&lt;/code&gt; ということが分かります
&lt;a href=&#34;http://perldoc.perl.org/UNIVERSAL.html&#34;&gt;http://perldoc.perl.org/UNIVERSAL.html&lt;/a&gt; の通りです
これで、もう多分、if (isa $foo &amp;lsquo;FOO&amp;rsquo;) とやってハマること？もないでしょう？&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;

package Dog;

sub new { bless {}, shift };

package main;

use Test::More;

my $dog = Dog-&amp;gt;new;

subtest &#39;isa&#39; =&amp;gt; sub {
    isa_ok $dog, &#39;Dog&#39;;
    isa_ok $dog, &#39;UNIVERSAL&#39;;
};

subtest &#39;methods&#39; =&amp;gt; sub {

    ok $dog-&amp;gt;can(&#39;can&#39;);
    ok $dog-&amp;gt;can(&#39;isa&#39;);
    ok $dog-&amp;gt;can(&#39;VERSION&#39;);
    ok $dog-&amp;gt;can(&#39;DOES&#39;);
};

subtest &#39;methods count&#39; =&amp;gt; sub {

    require Class::Inspector;
    is scalar @{Class::Inspector-&amp;gt;methods(&#39;UNIVERSAL&#39;)}, 4;

    is_deeply(Class::Inspector-&amp;gt;methods(&#39;Dog&#39;), [qw/new/]);
};

done_testing;
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;a-name-section7-ハマる例3-テストにて-a:ed130a5c49b36845906533f63e9cb3a3&#34;&gt;&lt;a name=&#34;section7&#34;&gt;ハマる例3 テストにて&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;生々しいですが、例2のClass::Inspector を使っていて、今、ミスった例です。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;

package Dog;

sub new { bless {}, shift };

package main;
use Test::More;
use Class::Inspector;

is_deeply Class::Inspector-&amp;gt;methods(&#39;Dog&#39;), [qw/new/];
# XXX failed!!
# =&amp;gt; Can&#39;t locate object method &amp;quot;is_deeply&amp;quot; via package &amp;quot;Class::Inspector&amp;quot; at can5.pl line 12

=pod
use utf8;
package Dog;
sub new {
    use warnings;
    use strict;
    bless {}, shift();
}
package main;
sub BEGIN {
    use warnings;
    use strict;
    require Test::More;
    do {
        &#39;Test::More&#39;-&amp;gt;import
    };
}
use Class::Inspector;
use warnings;
use strict;
&#39;Class::Inspector&#39;-&amp;gt;is_deeply-&amp;gt;methods(&#39;Dog&#39;), [&#39;new&#39;];

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;これは、要点だけを絞り出すと次のようになっています&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;package Foo;
sub new { bless {}, shift() }

use strict;
use warnings;
use utf8;

use Test::More;

isa_ok Foo-&amp;gt;new, &#39;Foo&#39;;

done_testing;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;# Deparse

package Foo;
sub new {
    bless {}, shift();
}
use utf8;
use Test::More;
use warnings;
use strict;
&#39;Foo&#39;-&amp;gt;isa_ok-&amp;gt;new, &#39;???&#39;;
done_testing();
/Users/kfly8/aa.pl syntax OK
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;実際にはまった例では、&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;is_deeply Class::Inspector-&amp;gt;methods(&#39;Dog&#39;), [qw/new/];
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;が、次のように評価されてしまい、残念なことになりました&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;&#39;Class::Inspector&#39;-&amp;gt;is_deeply-&amp;gt;methods(&#39;Dog&#39;), [&#39;new&#39;];
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;括弧付きで呼び出してあげてください&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;is_deeply(Class::Inspector-&amp;gt;methods(&#39;Dog&#39;), [&#39;new&#39;]);
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;a-name-section8-まとめ-a:ed130a5c49b36845906533f63e9cb3a3&#34;&gt;&lt;a name=&#34;section8&#34;&gt;まとめ&lt;/a&gt;&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;Perl には、method を呼び出す方法に、method $obj LIST のような呼び出し方もあり、それを間接オブジェクト記法という&lt;/li&gt;
&lt;li&gt;使いどころを（すごい）選べば、import constant FOO =&amp;gt; &amp;lsquo;foo&amp;rsquo; のような簡潔な表現になる&lt;/li&gt;
&lt;li&gt;よくあるハマり方

&lt;ul&gt;
&lt;li&gt;関数のexport漏れ

&lt;ul&gt;
&lt;li&gt;余談 prototype&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;暗黙なmethod定義&lt;/li&gt;
&lt;li&gt;func Class-&amp;gt;foo の Class-&amp;gt;func-&amp;gt;foo という誤読しやすい評価順&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;a-name-section9-明日-a:ed130a5c49b36845906533f63e9cb3a3&#34;&gt;&lt;a name=&#34;section9&#34;&gt;明日&lt;/a&gt;&lt;/h1&gt;

&lt;p&gt;18日目は、&lt;a href=&#34;http://qiita.com/waniji&#34;&gt;wanji&lt;/a&gt; さんです！&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>#Perl入学式 のお手伝いさせてもらってきた</title>
      <link>http://kfly8.github.io/post/supported-perl-entrance/</link>
      <pubDate>Sun, 30 Nov 2014 19:02:59 +0900</pubDate>
      
      <guid>http://kfly8.github.io/post/supported-perl-entrance/</guid>
      <description>

&lt;p&gt;&lt;a href=&#34;http://www.perl-entrance.org/&#34;&gt;Perl入学式&lt;/a&gt; に参加するのは初めてだったのですが、
サポーターとして参加させてもらいました。
お疲れ様でした！特に講師のid:xtetsuji さんお疲れ様でした！!&lt;/p&gt;

&lt;p&gt;「サブルーチンと正規表現」がお題でした。
資料は&lt;a href=&#34;https://github.com/perl-entrance-org/workshop-2014-04/blob/master/slide.md&#34;&gt;コチラ&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;寿司はコチラ。
&lt;blockquote class=&#34;twitter-tweet&#34; lang=&#34;ja&#34;&gt;&lt;p&gt;Perl入学寿司 &lt;a href=&#34;https://twitter.com/hashtag/Perl%E5%85%A5%E5%AD%A6%E5%BC%8F?src=hash&#34;&gt;#Perl入学式&lt;/a&gt; (@ 立ち喰い寿司 都々井 in 品川区, 東京都) &lt;a href=&#34;https://t.co/dBvh02MXCZ&#34;&gt;https://t.co/dBvh02MXCZ&lt;/a&gt; &lt;a href=&#34;http://t.co/MVMMTHvfco&#34;&gt;pic.twitter.com/MVMMTHvfco&lt;/a&gt;&lt;/p&gt;&amp;mdash; OGATA Tetsuji (@xtetsuji) &lt;a href=&#34;https://twitter.com/xtetsuji/status/538527365635514368&#34;&gt;2014, 11月 29&lt;/a&gt;&lt;/blockquote&gt;
美味かった。&lt;/p&gt;

&lt;h1 id=&#34;面白かった-罠がコチラ:b9ad6d015439b1465565681b73a51293&#34;&gt;面白かった(?)罠がコチラ&lt;/h1&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;

sub dump_hash {
    my $hash = @_;
    $hash-&amp;gt;{foo};
}

dump_hash({foo =&amp;gt; 1, bar =&amp;gt; 2});
# =&amp;gt; Can&#39;t use string (&amp;quot;1&amp;quot;) as a HASH ref while &amp;quot;strict refs&amp;quot; in use at foo.pl line 7.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;生徒:「&lt;code&gt;1&lt;/code&gt;って何?!?!」
おれ:「配列をスカラーで評価して、配列長..ですね&amp;hellip;」
生徒:「??????」
おれ:「ですよね!!!!!!!!」&lt;/p&gt;

&lt;p&gt;幸い？他のプログラミング言語を触っている人だったからか、
「Perlだと、どう値を使いたいか意思表示できて、
例えば、配列が欲しいのか、スカラが欲しいのかなど。
逆に言うと意思表示に慣れるまで、ハマります！！」
でコンテキストのことを濁し、次のような引数の取り方の例を見てもらったら納得してもらえたよう。&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;sub dump_hash2 {
    my $h   = @_; # bad...
    my ($h) = @_; # ok (補足: 括弧が、優先順位の括弧に見えてしまったよう。 my ($a,$b) = @_ の例も併わせて紹介して、リストの括弧と分かってもらえた。
    my ($h,)= @_; # ok (さらに補足: 人によっては配列をより意識する為にこう書く人もいる
    my $h   = shift; # ok
    my $h   = $_[0]; # ok
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;蛇足にこんな例も話したら、楽しんでもらえたよう（多分）&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;my @a  = (&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;);
#my @a = qw/ a b c d /; # これで上と同じ意味

my %hash  = ( a =&amp;gt; 1, b =&amp;gt; 2 );
#my %hash = ( &#39;a&#39;, 1, &#39;b&#39;, 2 );  # これで上と同じ意味
#my %hash = qw/ a 1 b 2 /;  # これも同じ意味
my @b     = ( &#39;a&#39;, 1, &#39;b&#39;, 2 );  # さらに配列として受け止めることもできる
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;慣れるのは苦労するかもしれないけど、、、
例えば、「対になっているデータが欲しいから、ハッシュにしよう！」
とか思った時に、特にこねくり回したことしなくて良いのが、個人的に楽だと思っている。&lt;/p&gt;

&lt;h1 id=&#34;完全なる蛇足:b9ad6d015439b1465565681b73a51293&#34;&gt;完全なる蛇足&lt;/h1&gt;

&lt;p&gt;楽しみついでに、&lt;a href=&#34;https://github.com/perl-entrance-org/workshop-2014-04/blob/master/slide.md#%E3%82%B5%E3%83%96%E3%83%AB%E3%83%BC%E3%83%81%E3%83%B3%E3%81%AE%E5%AE%9A%E7%BE%A9-2&#34;&gt;サブルーチンの定義&lt;/a&gt;に関して、
「!」「数字」や「日本語」をサブルーチン名に使ったりする応用例？を書いた。&lt;/p&gt;

&lt;p&gt;この辺、YAPC::Asia 2014 のid:karupaneruraの&lt;a href=&#34;http://yapcasia.org/2014/talk/show/25f99ab0-fa15-11e3-b7e8-e4a96aeab6a4&#34;&gt;meta programmingの話&lt;/a&gt; が詳しい。(demoが多いので、動画がおすすめ）&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;

use Test::More;

{
    no strict qw/refs/;
    *{&#39;world!&#39;} = sub { &#39;world&#39; };
    is *{&#39;world!&#39;}{CODE}-&amp;gt;(), &#39;world&#39;, &#39;symbol table call&#39;;
}

done_testing;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;

use Test::More;

sub こんにちは { &#39;hello&#39; }
is こんにちは(), &#39;hello&#39;;

done_testing;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use strict;
use warnings;
use utf8;

use Test::More;
use Package::Stash;

my $stash = Package::Stash-&amp;gt;new(&#39;Foo&#39;);
$stash-&amp;gt;add_symbol(&#39;&amp;amp;hello world!&#39;, sub { &#39;hello&#39; });

subtest &#39;by get_symbol&#39; =&amp;gt; sub {
    my $code = $stash-&amp;gt;get_symbol(&#39;&amp;amp;hello world!&#39;);
    is $code-&amp;gt;(), &#39;hello&#39;
};

subtest &#39;by pkg&#39; =&amp;gt; sub {
    ok Foo-&amp;gt;can(&#39;hello world!&#39;), &#39;can?&#39;;
    my $code = Foo-&amp;gt;can(&#39;hello world!&#39;);
    is $code-&amp;gt;(), &#39;hello&#39;;

    my $method = &#39;hello world!&#39;;
    is Foo-&amp;gt;$method(), &#39;hello&#39;;
};

done_testing;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;そんなこんなで、Perl入学式楽しませてもらいました！！
ありがとうございました！
またの機会もよろしくお願いします！&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>#chibapm 5で好き放題ランダウ記号の話をしてきた</title>
      <link>http://kfly8.github.io/post/chibapm5/</link>
      <pubDate>Sat, 11 Oct 2014 19:25:28 +0900</pubDate>
      
      <guid>http://kfly8.github.io/post/chibapm5/</guid>
      <description>&lt;p&gt;数学の話を息抜きにしてきた。
グラフが、写真なあたりまさに息抜き←手抜き&lt;/p&gt;

&lt;iframe src=&#34;//slides.com/kfly8/landau_symbol/embed&#34; width=&#34;576&#34; height=&#34;420&#34; scrolling=&#34;no&#34; frameborder=&#34;0&#34; webkitallowfullscreen mozallowfullscreen allowfullscreen&gt;&lt;/iframe&gt;

&lt;p&gt;インデックス構造によって計算オーダーが変わったりするので、
云々かんぬんで久しぶりに数学に触れられて、楽しかった。&lt;/p&gt;

&lt;p&gt;#chibapmの懐の深さに感謝！&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>#gotandapm たのしんできた</title>
      <link>http://kfly8.github.io/post/gotandapm2/</link>
      <pubDate>Fri, 19 Sep 2014 13:22:07 +0900</pubDate>
      
      <guid>http://kfly8.github.io/post/gotandapm2/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://gotanda-pm.connpass.com/event/8404/&#34;&gt;Gotanda.pm #2&lt;/a&gt;で
飲んだり発表したり話を聞いたり飲んだりしてきました１
主催のid:karupaneruraありがとうございました！！！！！&lt;/p&gt;

&lt;p&gt;isucon楽しい！！！！ので参加すると良いって気持ちで発表してきました&amp;gt;&amp;lt;&lt;/p&gt;

&lt;iframe src=&#34;//slides.com/kfly8/isucon_ttp/embed?style=light&#34; width=&#34;576&#34; height=&#34;420&#34; scrolling=&#34;no&#34; frameborder=&#34;0&#34; webkitallowfullscreen mozallowfullscreen allowfullscreen&gt;&lt;/iframe&gt;

&lt;p&gt;gotandapmはまた１２月の開催されるそうで楽しみです！！！&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://instagram.com/p/spC-tSoDCr/&#34;&gt;&lt;img src=&#34;http://instagram.com/p/spC-tSoDCr/media/?size=l&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ほんとにあったスキーマの話「ソーシャルゲーム」と題して、YAPCのトーク応募してみた</title>
      <link>http://kfly8.github.io/post/apply-yapcasia2014/</link>
      <pubDate>Fri, 04 Jul 2014 16:08:19 +0900</pubDate>
      
      <guid>http://kfly8.github.io/post/apply-yapcasia2014/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://yapcasia.org/2014/talk/list&#34;&gt;YAPC::Asiaのトーク&lt;/a&gt;の応募数が尋常じゃないので、駆け込みブログです&amp;gt;&amp;lt;
(YAPC終わった後に、yet another yapcをするしかないんじゃないか？！)&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://yapcasia.org/2014/talk/show/ce6e777e-fb91-11e3-b7e8-e4a96aeab6a4&#34;&gt;http://yapcasia.org/2014/talk/show/ce6e777e-fb91-11e3-b7e8-e4a96aeab6a4&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;アプリケーション層でも、コードの規模感が少し大きくなった、
「続・初めてのPerl」くらいなレベル感な話になれば、、いいな、、と思っています。&lt;/p&gt;

&lt;p&gt;以下はなんとなく話せればと思う事の断片。&lt;/p&gt;

&lt;script src=&#34;https://gist.github.com/kfly8/d2d23c435801551a278f.js&#34;&gt;&lt;/script&gt;
</description>
    </item>
    
    <item>
      <title>#kyotopm にいってもくもくしてきた</title>
      <link>http://kfly8.github.io/post/kyotopm4/</link>
      <pubDate>Mon, 01 Apr 2013 00:14:36 +0900</pubDate>
      
      <guid>http://kfly8.github.io/post/kyotopm4/</guid>
      <description>

&lt;p&gt;そうだ、京都に行って来ましたー&lt;/p&gt;

&lt;p&gt;2013-03-30 @はてな
&lt;a href=&#34;http://www.zusaar.com/event/582004&#34;&gt;http://www.zusaar.com/event/582004&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;blockquote class=&#34;instagram-media&#34; data-instgrm-captioned data-instgrm-version=&#34;6&#34; style=&#34; background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:658px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);&#34;&gt;&lt;div style=&#34;padding:8px;&#34;&gt; &lt;div style=&#34; background:#F8F8F8; line-height:0; margin-top:40px; padding:50% 0; text-align:center; width:100%;&#34;&gt; &lt;div style=&#34; background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAAGFBMVEUiIiI9PT0eHh4gIB4hIBkcHBwcHBwcHBydr+JQAAAACHRSTlMABA4YHyQsM5jtaMwAAADfSURBVDjL7ZVBEgMhCAQBAf//42xcNbpAqakcM0ftUmFAAIBE81IqBJdS3lS6zs3bIpB9WED3YYXFPmHRfT8sgyrCP1x8uEUxLMzNWElFOYCV6mHWWwMzdPEKHlhLw7NWJqkHc4uIZphavDzA2JPzUDsBZziNae2S6owH8xPmX8G7zzgKEOPUoYHvGz1TBCxMkd3kwNVbU0gKHkx+iZILf77IofhrY1nYFnB/lQPb79drWOyJVa/DAvg9B/rLB4cC+Nqgdz/TvBbBnr6GBReqn/nRmDgaQEej7WhonozjF+Y2I/fZou/qAAAAAElFTkSuQmCC); display:block; height:44px; margin:0 auto -44px; position:relative; top:-22px; width:44px;&#34;&gt;&lt;/div&gt;&lt;/div&gt; &lt;p style=&#34; margin:8px 0 0 0; padding:0 4px;&#34;&gt; &lt;a href=&#34;https://www.instagram.com/p/Xefv11oDDR/&#34; style=&#34; color:#000; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none; word-wrap:break-word;&#34; target=&#34;_blank&#34;&gt;はてなのTシャツもらた！#kyotopm 発表done 懇親会へ&lt;/a&gt;&lt;/p&gt; &lt;p style=&#34; color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;&#34;&gt;@kfly8が投稿した写真 - &lt;time style=&#34; font-family:Arial,sans-serif; font-size:14px; line-height:17px;&#34; datetime=&#34;2013-03-30T09:23:43+00:00&#34;&gt;2013  3月 30 2:23午前 PDT&lt;/time&gt;&lt;/p&gt;&lt;/div&gt;&lt;/blockquote&gt;
&lt;script async defer src=&#34;//platform.instagram.com/en_US/embeds.js&#34;&gt;&lt;/script&gt;
はてなのTシャツもらた。あざます！&lt;/p&gt;

&lt;p&gt;今回のKyoto.pm は、
もくもくするハッカソンイベントでした。
自分は、数式のエディタ作ってみました。(ほとんどドキュメント読んでる時間でしたが&amp;hellip;）&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://mathml-kfly8.dotcloud.com/&#34;&gt;http://mathml-kfly8.dotcloud.com/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kfly8/Text2MathMLEditor&#34;&gt;https://github.com/kfly8/Text2MathMLEditor&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;発表していた人の-わずかな-めも:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;発表していた人の（わずかな）めも&amp;hellip;&lt;/h1&gt;

&lt;h2 id=&#34;cinnamonの並列処理:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;Cinnamonの並列処理&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;id:shiba_yu36&lt;/li&gt;
&lt;li&gt;並列処理のテストを書くのに、サーバ環境を２つ用意しないといけないことに気づいて、、&lt;/li&gt;
&lt;li&gt;vagrant&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;黒い画面でキャラを:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;黒い画面でキャラを。&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;id:kiyotune&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kiyotune/my_logo/commits?author=kiyotune&#34;&gt;https://github.com/kiyotune/my_logo/commits?author=kiyotune&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;動物の森関連の便利なのを子供に使って試してもらったお話&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;http-xpathfeed-com:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;&lt;a href=&#34;http://xpathfeed.com/&#34;&gt;http://xpathfeed.com/&lt;/a&gt;&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;id:onishi&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/onishi/xpathfeed&#34;&gt;https://github.com/onishi/xpathfeed&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;net-signalet:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;Net-Signalet&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;id:y_uuki&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/y-uuki/Net-Signalet&#34;&gt;https://github.com/y-uuki/Net-Signalet&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;iperf&lt;/li&gt;
&lt;li&gt;opcontrol&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;以下、その日、発表で使った資料(にちょっと手を加えたもの)&lt;/p&gt;

&lt;p&gt;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;&amp;gt;8&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;&lt;/p&gt;

&lt;h1 id=&#34;自己紹介:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;自己紹介&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;kfly8&lt;/li&gt;
&lt;li&gt;朝まで飲んで、品川発の新幹線に乗り込む。&lt;/li&gt;
&lt;li&gt;もしかして: ねむい&lt;/li&gt;
&lt;li&gt;普段は、MFで、ソーシャルアプリ作ってます。&lt;/li&gt;
&lt;li&gt;よろしくお願いします。&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;つくったもの:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;つくったもの&lt;/h1&gt;

&lt;p&gt;txtをMathMLに変換してくれるwebあぷぷ&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://mathml-kfly8.dotcloud.com/&#34;&gt;http://mathml-kfly8.dotcloud.com/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kfly8/Text2MathMLEditor&#34;&gt;https://github.com/kfly8/Text2MathMLEditor&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;仕組みの概要:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;仕組みの概要&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;変換部分は、 Text::ASCIIMathML にお任せ&lt;/li&gt;
&lt;li&gt;だいたいのLaTeXコマンドをサポートしている&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://search.cpan.org/~nodine/Text-ASCIIMathML-0.81/lib/Text/ASCIIMathML.pm&#34;&gt;http://search.cpan.org/~nodine/Text-ASCIIMathML-0.81/lib/Text/ASCIIMathML.pm&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;text-asciimathml:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;Text::ASCIIMathML&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;$parser     = new Text::ASCIIMathML();
$mathMLTree = $parser-&amp;gt;TextToMathMLTree(&#39;int_0^1 e^x dx&#39;);
$mathMLTree-&amp;gt;text();
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;動機を:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;動機を&amp;hellip;&lt;/h1&gt;

&lt;h2 id=&#34;weighted-shuffle:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;weighted shuffle&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;@weighed_list = [ { value =&amp;gt; &#39;hoge&#39;, weight =&amp;gt; 10 }, { value =&amp;gt; &#39;fuga&#39;, weight =&amp;gt; 100 } ];

@weighted_shuffle_list = map { $_-&amp;gt;{value} }
    sort { $b-&amp;gt;{rand} &amp;lt;=&amp;gt; $a-&amp;gt;{rand} }
    map {
        {
            rand  =&amp;gt; rand($_-&amp;gt;{weight}),
            value =&amp;gt; $_-&amp;gt;{value},
        }
    } @weighted_list;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;ロジック:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;ロジック&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;weight が大きければ大きいほど、大きな乱数が得られる可能性が高いから、(一応)weightを考慮した配列にはなってる&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kfly8/p5-Data-WeightedRoundRobin/commit/fde15205df918e4130021c532b24418e1d81c8bb&#34;&gt;https://github.com/kfly8/p5-Data-WeightedRoundRobin/commit/fde15205df918e4130021c532b24418e1d81c8bb&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;(カッとなって書いたので、D::WR に書くべきかどうかわからん)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;weightの価値が知りたい:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;weightの価値が知りたい&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;この確率は、積分で表せるのだが&amp;hellip;&lt;/li&gt;
&lt;li&gt;&lt;span style=&#34;font-size: 150%&#34;&gt;&lt;b&gt;&lt;em&gt;なんか数式で表したいなー&lt;/em&gt;&lt;/b&gt;&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;これが、動機!!!!&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;mathmlって:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;MathMLって?&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;MathML は数式をマークアップするための XML 語彙&lt;/li&gt;
&lt;li&gt;要は、xmlなので、DOM操作したり、検索しやすかったりする&lt;/li&gt;

&lt;li&gt;&lt;p&gt;非対応なブラウザがある&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;ASCIIMathML&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://www.ibm.com/developerworks/jp/xml/library/x-mathml3/&#34;&gt;http://www.ibm.com/developerworks/jp/xml/library/x-mathml3/&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://en.wikipedia.org/wiki/ASCIIMathML&#34;&gt;http://en.wikipedia.org/wiki/ASCIIMathML&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ASCIIMathML is a client-side mathematical markup language for displaying mathematical expressions in web browsers.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;LaTeXMathML&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;ASCIIMathMLの拡張のよう #TODO&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;数式を表す他の手段は:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;数式を表す他の手段は？&lt;/h1&gt;

&lt;h2 id=&#34;画像を使う:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;画像を使う&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Google Chart Tool&lt;/li&gt;
&lt;li&gt;&lt;img src=&#34;http://chart.apis.google.com/chart?cht=tx&amp;amp;chl=x=\frac{-b\pm\sqrt{b^2-4ac}}{2a}&#34; alt=&#34;&#34; /&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;画像で数式を表現&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;CodeCogs&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;画像で数式を表現. 解像度を指定できる.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;画像で数式を表した場合の問題点:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;画像で数式を表した場合の問題点&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;機械に優しくない&lt;/li&gt;
&lt;li&gt;Liquidレイアウトしずらい&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;非対応ブラウザ対応:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;非対応ブラウザ対応&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;MathJax ( &lt;a href=&#34;http://www.mathjax.org/&#34;&gt;http://www.mathjax.org/&lt;/a&gt; )&lt;/li&gt;

&lt;li&gt;&lt;p&gt;MathMLの非対応のブラウザでも、WebFont使ってみれるようにしてくれる君&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;jsMath ( &lt;a href=&#34;http://www.math.union.edu/~dpvc/jsMath/&#34;&gt;http://www.math.union.edu/~dpvc/jsMath/&lt;/a&gt; )&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;MathJax からフォークしたよう #TODO&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;今後どうしたいか:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;今後どうしたいか&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;変換精度を上げる&lt;/li&gt;
&lt;li&gt;エディタとしての使い勝手を上げる&lt;/li&gt;
&lt;li&gt;例えば、オフラインで動かしたいので、JSで変換できるようにしたい&lt;/li&gt;

&lt;li&gt;&lt;p&gt;画像にしてダウンロード、シェアできるようにしたい。&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;数式をカジュアルに使いたい！&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;参考url:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;参考URL&lt;/h1&gt;

&lt;h2 id=&#34;mathml:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;MathML&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;LaTeXMathML&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://math.etsu.edu/LaTeXMathML&#34;&gt;http://math.etsu.edu/LaTeXMathML&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;ASCIIMathML の拡張のよう #TODO&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;MathML ver2 @2003 -&amp;gt; ver3 @2010に移行しているので、どう違うのか調べる。 #TODO&lt;/p&gt;

&lt;h2 id=&#34;変換ツール:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;変換ツール&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Pandoc&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Haskel でできた、いろんな形式をサポートしているのの。markdown -&amp;gt; tex とかできるよう。epub とかに変換できるよう。#TODO&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;texのオンラインエディタ&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://ja.numberempire.com/texequationeditor/equationeditor.php&#34;&gt;http://ja.numberempire.com/texequationeditor/equationeditor.php&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;手書きで数式を表せる&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://detexify.kirelabs.org/classify.html&#34;&gt;http://detexify.kirelabs.org/classify.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;最後に:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;最後に&lt;/h1&gt;

&lt;p&gt;もくもくコードが書けて楽しかったです。
畳でコード書けるっていいですね！
楽しかったです！&lt;/p&gt;

&lt;p&gt;ありがとうございました!!&lt;/p&gt;

&lt;p&gt;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;-8&amp;lt;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&lt;/p&gt;

&lt;p&gt;桜きれいだったー。&lt;/p&gt;

&lt;p&gt;&lt;blockquote class=&#34;instagram-media&#34; data-instgrm-captioned data-instgrm-version=&#34;6&#34; style=&#34; background:#FFF; border:0; border-radius:3px; box-shadow:0 0 1px 0 rgba(0,0,0,0.5),0 1px 10px 0 rgba(0,0,0,0.15); margin: 1px; max-width:658px; padding:0; width:99.375%; width:-webkit-calc(100% - 2px); width:calc(100% - 2px);&#34;&gt;&lt;div style=&#34;padding:8px;&#34;&gt; &lt;div style=&#34; background:#F8F8F8; line-height:0; margin-top:40px; padding:50% 0; text-align:center; width:100%;&#34;&gt; &lt;div style=&#34; background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAMAAAApWqozAAAAGFBMVEUiIiI9PT0eHh4gIB4hIBkcHBwcHBwcHBydr+JQAAAACHRSTlMABA4YHyQsM5jtaMwAAADfSURBVDjL7ZVBEgMhCAQBAf//42xcNbpAqakcM0ftUmFAAIBE81IqBJdS3lS6zs3bIpB9WED3YYXFPmHRfT8sgyrCP1x8uEUxLMzNWElFOYCV6mHWWwMzdPEKHlhLw7NWJqkHc4uIZphavDzA2JPzUDsBZziNae2S6owH8xPmX8G7zzgKEOPUoYHvGz1TBCxMkd3kwNVbU0gKHkx+iZILf77IofhrY1nYFnB/lQPb79drWOyJVa/DAvg9B/rLB4cC+Nqgdz/TvBbBnr6GBReqn/nRmDgaQEej7WhonozjF+Y2I/fZou/qAAAAAElFTkSuQmCC); display:block; height:44px; margin:0 auto -44px; position:relative; top:-22px; width:44px;&#34;&gt;&lt;/div&gt;&lt;/div&gt; &lt;p style=&#34; margin:8px 0 0 0; padding:0 4px;&#34;&gt; &lt;a href=&#34;https://www.instagram.com/p/XgnafPIDFU/&#34; style=&#34; color:#000; font-family:Arial,sans-serif; font-size:14px; font-style:normal; font-weight:normal; line-height:17px; text-decoration:none; word-wrap:break-word;&#34; target=&#34;_blank&#34;&gt;手鞠鮨ー。&lt;/a&gt;&lt;/p&gt; &lt;p style=&#34; color:#c9c8cd; font-family:Arial,sans-serif; font-size:14px; line-height:17px; margin-bottom:0; margin-top:8px; overflow:hidden; padding:8px 0 7px; text-align:center; text-overflow:ellipsis; white-space:nowrap;&#34;&gt;@kfly8が投稿した写真 - &lt;time style=&#34; font-family:Arial,sans-serif; font-size:14px; line-height:17px;&#34; datetime=&#34;2013-03-31T05:09:11+00:00&#34;&gt;2013  3月 30 10:09午後 PDT&lt;/time&gt;&lt;/p&gt;&lt;/div&gt;&lt;/blockquote&gt;
&lt;script async defer src=&#34;//platform.instagram.com/en_US/embeds.js&#34;&gt;&lt;/script&gt;&lt;/p&gt;

&lt;h2 id=&#34;todo-教えてもらったラーメン屋に行く:5050f171b3cde52c8d79954933d6a9e4&#34;&gt;TODO: 教えてもらったラーメン屋に行く。&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://tabelog.com/kyoto/A2602/A260201/26006820/&#34;&gt;http://tabelog.com/kyoto/A2602/A260201/26006820/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.takakura-nijo.jp/&#34;&gt;http://www.takakura-nijo.jp/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;b&gt;&lt;em&gt;新しい年度が始まる！がんばろうー。&lt;/em&gt;&lt;/b&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>suppressしたrow objの存在しないkeyにアクセスして、Data::WeightedRoundRobin の初期値が使われて...orz  </title>
      <link>http://kfly8.github.io/post/suppress-row-and-dwr/</link>
      <pubDate>Wed, 23 Jan 2013 00:51:35 +0900</pubDate>
      
      <guid>http://kfly8.github.io/post/suppress-row-and-dwr/</guid>
      <description>&lt;p&gt;たった今、かなしい！となったので勢いに任せて書きます.&lt;/p&gt;

&lt;p&gt;普段、Data::WeightedRoundRobin のSugarを次のような感じで
exportして使っています.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;use Data::WeightedRoundRobin;

sub list2dwr (&amp;amp;@) {## no critic
    my $code = shift;
    return Data::WeightedRoundRobin-&amp;gt;new([ map { $code-&amp;gt;($_) } @_ ])
}

my $dwr = list2dwr {
    +{
       key    =&amp;gt; $_,
       value  =&amp;gt; $_ * $_,
       weight =&amp;gt; $_,
    }
} qw/1 2 3 4/;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;普段、Teng のsuppress_object_creation も、データが多くなるってとき、
使っています.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;my @rows = do {
    my $iter = model(&#39;DB::Hoge&#39;)-&amp;gt;search(+{ user_id =&amp;gt; $args-&amp;gt;{user_id} });
    $iter-&amp;gt;suppress_object_creation(1);
    $iter-&amp;gt;all;
};
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;で、はまったコードはこれ.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;my @rows = do {
    my $iter = model(&#39;DB::Hoge&#39;)-&amp;gt;search(+{ user_id =&amp;gt; $args-&amp;gt;{user_id} });
    $iter-&amp;gt;suppress_object_creation(1);
    $iter-&amp;gt;all;
};

my $dwr = list2dwr {
    +{
       key    =&amp;gt; $_-&amp;gt;{id},
       value  =&amp;gt; $_,
       weight =&amp;gt; $_-&amp;gt;{weihgt},
    }
} @rows;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;分かりにくいと思うので、拡大！！
コレ！！！！！&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;weight =&amp;gt; $_-&amp;gt;{weihgt}, # not weight!!!
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;順としては&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;$_-&amp;gt;{weihgt} が undefined&lt;/li&gt;
&lt;li&gt;Data::WeightedRoundRobin の、DEFAULT_WEIGHT 100が適用される&lt;/li&gt;
&lt;li&gt;orz&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;テストコードで気づくと思いつつ、意地悪なテストじゃなかったら、すり抜けるなーと&lt;/p&gt;

&lt;p&gt;普段、次のような恩恵を自然と預かっているんだなと改め思う
- $_-&amp;gt;weight に対するアクセスが普段メソッド通しているので、typoに気づく
- hashへのアクセスもバリデータを通しているので、気づく
- readonly にしていればとか、、、&lt;/p&gt;

&lt;p&gt;だから、どうしよう&amp;hellip;
と思ったが少し閃いた&lt;/p&gt;

&lt;p&gt;どうせ、ラップして使っているなら、default値は使わないぜ作戦&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-perl&#34;&gt;sub list2dwr (&amp;amp;@) {## no critic
    my $code = shift;
    return Data::WeightedRoundRobin-&amp;gt;new([ map { $code-&amp;gt;($_) } @_ ], { default_weight =&amp;gt; sub { die } } )
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Data::WeightedRoundRobin で、default_weight がコードリファレンスだったら実行してもらう必要があるけど、、&lt;/p&gt;

&lt;p&gt;あとは、suppress_object_creation でreadonlyにする作戦？！&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Kyoto.pmに参加。温泉発火村のLTもやらせてもらった。</title>
      <link>http://kfly8.github.io/post/kyotopm1/</link>
      <pubDate>Sun, 18 Mar 2012 00:39:57 +0900</pubDate>
      
      <guid>http://kfly8.github.io/post/kyotopm1/</guid>
      <description>&lt;p&gt;こんばんは。
初開催の&lt;a href=&#34;http://www.atnd.org/events/25439&#34;&gt;Kyoto.pm&lt;/a&gt;に参加させてもらいました。
そして、温泉ハッカソンを企画した話で初LTもさせてもらいました。&lt;/p&gt;

&lt;p&gt;会場を貸してくださった、はてなさん。
運営の方々。楽しい時間をありがとうございました！
参加されている方とも交流できてよかったですー&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;発表資料&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;iframe src=&#34;//www.slideshare.net/slideshow/embed_code/key/15PFyXmoO26uis&#34; width=&#34;595&#34; height=&#34;485&#34; frameborder=&#34;0&#34; marginwidth=&#34;0&#34; marginheight=&#34;0&#34; scrolling=&#34;no&#34; style=&#34;border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;&#34; allowfullscreen&gt; &lt;/iframe&gt; &lt;div style=&#34;margin-bottom:5px&#34;&gt; &lt;strong&gt; &lt;a href=&#34;//www.slideshare.net/KentaKobayashi1/ss-12047154&#34; title=&#34;ハッカソンを企画して&#34; target=&#34;_blank&#34;&gt;ハッカソンを企画して&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href=&#34;//www.slideshare.net/KentaKobayashi1&#34; target=&#34;_blank&#34;&gt;Kenta Kobayashi&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/p&gt;

&lt;p&gt;夜遅くまで懇親会に参加させてもらって、
Perlのコミュニティっていいなーと思ったのでした。
YAPCやハッカソンなどでも何度も感じさせてもらってて、
使っている技術で繋がれるのっていいですね。&lt;/p&gt;

&lt;p&gt;例えば、id:xaicronさんが懇親会から参加したりするのって、
Perlのコミュニティの魅力がとってもあるか、@xaicronさんが変なのか
どっちかだと思うんですよね。&lt;/p&gt;

&lt;p&gt;仕事を始めて、約１年。
エンジニアって仕事を選んで良かったなと思ったのでした。&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;めもめも&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;id:yappo さん&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ACME::FizzBuzzの実装があれ&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/yoshiki/markdown2impress&#34;&gt;https://github.com/yoshiki/markdown2impress&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;id:nekokak さん&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Teng開発者募集&lt;/li&gt;
&lt;li&gt;コミュニティで開発できたらいい&lt;/li&gt;
&lt;li&gt;ORM&lt;/li&gt;
&lt;li&gt;データとオブジェクトの溝を埋める&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;id:karupanerura&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;XOClock&lt;/li&gt;
&lt;li&gt;指定時刻にジョブを実行する&lt;/li&gt;
&lt;li&gt;冗長性を持たせられたら、うまー。&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;id:hakobe932 さん&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ruby-git&lt;/li&gt;
&lt;li&gt;Git.pm&lt;/li&gt;
&lt;li&gt;Git::Class / Git::Wrapper&lt;/li&gt;
&lt;li&gt;Git::Repositry&lt;/li&gt;
&lt;li&gt;Guita::Mapper::Git&lt;/li&gt;
&lt;li&gt;libgit2&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;id:antipop さん&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Data::Mapper&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kentaro/data-mapper&#34;&gt;https://github.com/kentaro/data-mapper&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;LT&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Text::Hatena:oEmbed&lt;/li&gt;
&lt;li&gt;SQL::Object&lt;/li&gt;
&lt;li&gt;Test::Successful&lt;/li&gt;
&lt;li&gt;Test::Flatten&lt;/li&gt;
&lt;li&gt;DBIx::QueryLog&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;余談&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;観光地のpmは、翌日も楽しめていいですねんw&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>